# SOPS Configuration File
#
# This file tells sops which keys to use for encrypting secrets.
#
# To set up:
# 1. Get your server's age public key:
#    ssh root@chestnut.nmsd.xyz "cat /etc/ssh/ssh_host_ed25519_key.pub" | ssh-to-age
#
# 2. Copy this file: cp .sops.yaml.example .sops.yaml
#
# 3. Replace the example age key below with your actual key
#
# 4. Commit .sops.yaml to git (it contains only public keys, safe to commit)

keys:
  # Chestnut server - SSH host key converted to age format
  # Replace with output from: ssh root@chestnut "cat /etc/ssh/ssh_host_ed25519_key.pub" | ssh-to-age
  - &chestnut age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p

  # Add more servers here as needed:
  # - &another-server age1...

creation_rules:
  # Chestnut server secrets
  - path_regex: hosts/chestnut/secrets\.yaml$
    key_groups:
      - age:
          - *chestnut

  # VM secrets (if needed)
  # - path_regex: hosts/vm/secrets\.yaml$
  #   key_groups:
  #     - age:
  #         - *vm

  # Global secrets accessible by all hosts
  # - path_regex: secrets/common\.yaml$
  #   key_groups:
  #     - age:
  #         - *chestnut
  #         - *another-server
